{"run_id": "a6b91bf553d7454fa97b241dd7b599c5", "test_id": "test/test_live_e27_log.py::test_live_log_domain", "record_type": "test_start", "t_ms": 0, "ts_utc": "2026-01-18T06:13:21Z", "meta": {"pid": 31196}}
{"run_id": "a6b91bf553d7454fa97b241dd7b599c5", "test_id": "test/test_live_e27_log.py::test_live_log_domain", "record_type": "test_end", "t_ms": 22624, "ts_utc": "2026-01-18T06:13:43Z", "outcome": "fail", "error": {"when": "call", "longrepr": "live_e27_client = <elke27_lib.client.Elke27Client object at 0x108b39040>\n\n    @pytest.mark.live_e27\n    @pytest.mark.asyncio\n    async def test_live_log_domain(live_e27_client: Elke27Client) -> None:\n        index_payload = await _execute_or_wait_log_state(\n            live_e27_client,\n            \"log_get_index\",\n            \"get_index\",\n            timeout_s=_LIVE_TIMEOUT_S,\n            allow_missing=True,\n        )\n        if index_payload:\n            assert_payload_shape(\"log_get_index\", index_payload)\n            print(f\"log_get_index: {index_payload}\")\n        else:\n            print(\"log_get_index: no response or broadcast\")\n    \n        table_payload = await _execute_or_wait_log_state(\n            live_e27_client,\n            \"log_get_table_info\",\n            \"get_table_info\",\n            timeout_s=_LIVE_TIMEOUT_S,\n        )\n        assert_payload_shape(\"log_get_table_info\", table_payload)\n        print(f\"log_get_table_info: {table_payload}\")\n    \n        attribs_payload = await _execute_or_wait_log_state(\n            live_e27_client,\n            \"log_get_attribs\",\n            \"get_attribs\",\n            timeout_s=_LIVE_TIMEOUT_S,\n        )\n        assert_payload_shape(\"log_get_attribs\", attribs_payload)\n        print(f\"log_get_attribs: {attribs_payload}\")\n    \n        trouble_payload = await _execute_or_wait_log_state(\n            live_e27_client,\n            \"log_get_trouble\",\n            \"get_trouble\",\n            timeout_s=_LIVE_TIMEOUT_S,\n        )\n>       assert_payload_shape(\"log_get_trouble\", trouble_payload)\n\ntest/test_live_e27_log.py:97: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncommand_key = 'log_get_trouble', payload = {'error_code': 0, 'troubles': []}\n\n    def assert_payload_shape(command_key: str, payload: Mapping[str, object] | None) -> None:\n        if payload is None:\n            raise AssertionError(f\"{command_key}: missing payload\")\n        if not isinstance(payload, Mapping):\n            raise AssertionError(f\"{command_key}: payload must be a mapping (got {type(payload).__name__})\")\n    \n        required = _REQUIRED_KEYS.get(command_key)\n        if required is None:\n            raise AssertionError(f\"{command_key}: no payload shape registered\")\n    \n        target = _select_payload(command_key, payload)\n        optional = _OPTIONAL_KEYS.get(command_key, ())\n        required_sets = [required]\n        required_sets.extend(_ALTERNATE_REQUIRED.get(command_key, ()))\n        for required_set in required_sets:\n            missing = [key for key in required_set if key not in target and key not in optional]\n            if not missing:\n                return\n>       raise AssertionError(f\"{command_key}: missing keys {missing} in payload {target!r}\")\nE       AssertionError: log_get_trouble: missing keys ['log_full'] in payload {'troubles': [], 'error_code': 0}\n\ntest/helpers/payload_validation.py:216: AssertionError"}}
