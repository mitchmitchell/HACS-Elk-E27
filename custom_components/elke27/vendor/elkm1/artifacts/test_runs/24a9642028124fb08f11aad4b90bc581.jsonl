{"run_id": "24a9642028124fb08f11aad4b90bc581", "test_id": "test/test_e27_network_param_live.py::test_live_network_param_getters", "record_type": "test_start", "t_ms": 0, "ts_utc": "2025-12-29T08:37:07Z", "meta": {"pid": 94893}}
{"run_id": "24a9642028124fb08f11aad4b90bc581", "test_id": "test/test_e27_network_param_live.py::test_live_network_param_getters", "record_type": "test_end", "t_ms": 201, "ts_utc": "2025-12-29T08:37:07Z", "outcome": "fail", "error": {"when": "call", "longrepr": "@pytest.mark.integration\n    @pytest.mark.asyncio\n    async def test_live_network_param_getters() -> None:\n        log_level = str(_env(\"LOG_LEVEL\", \"INFO\") or \"INFO\").upper()\n        logging.basicConfig(level=getattr(logging, log_level, logging.INFO), force=True)\n        logging.getLogger(\"elke27_lib.session\").setLevel(logging.DEBUG)\n    \n        host = _require_env(\"ELKE27_HOST\")\n        port = int(_env(\"ELKE27_PORT\", \"2101\") or 2101)\n        access_code = _require_env(\"ELKE27_ACCESS_CODE\")\n        passphrase = _require_env(\"ELKE27_PASSPHRASE\")\n        mn = _require_env(\"ELKE27_MN\")\n        sn = _require_env(\"ELKE27_SN\")\n        fwver = _require_env(\"ELKE27_FWVER\")\n        hwver = _require_env(\"ELKE27_HWVER\")\n        osver = _require_env(\"ELKE27_OSVER\")\n        timeout_s = float(_env(\"ELKE27_TIMEOUT_S\", \"10.0\") or 10.0)\n    \n        client_identity = linking.E27Identity(mn=mn, sn=sn, fwver=fwver, hwver=hwver, osver=osver)\n        elk = Elk(features=[\"elke27_lib.features.network_param\"])\n    \n        panel = {\"host\": host, \"port\": port}\n        creds = _Credentials(access_code=access_code, passphrase=passphrase)\n        link_keys = await elk.link(panel, client_identity, creds, timeout_s=timeout_s)\n        session_cfg = SessionConfig(host=host, port=port, hello_timeout_s=timeout_s)\n        await elk.connect(link_keys, client_identity=client_identity, session_config=session_cfg)\n    \n        pin_value = _env(\"ELKE27_PIN\")\n        if pin_value:\n            pin = int(pin_value)\n            auth_msg = {\"seq\": 110, \"authenticate\": {\"pin\": pin}}\n            elk.session.send_json(auth_msg)\n            auth_reply = elk.session.recv_json(timeout_s=2.0)\n            print(f\"Authenticate reply: {auth_reply}\")\n    \n        seq = elk.request((\"network\", \"get_ssid\"))\n        print(f\"Sent network.get_ssid seq={seq}\")\n        evt = _wait_for_auth_required(elk, NetworkSsidResultsUpdated.KIND, timeout_s)\n        if evt is None:\n            await elk.close()\n            pytest.fail(\"Timed out waiting for AuthorizationRequiredEvent (SSID).\")\n        print(f\"Authorization required for SSID (error_code={evt.error_code})\")\n    \n        seq = elk.request((\"network\", \"get_rssi\"))\n        print(f\"Sent network.get_rssi seq={seq}\")\n>       evt = _wait_for_auth_required(elk, NetworkRssiUpdated.KIND, timeout_s)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\ntest/test_e27_network_param_live.py:87: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nelk = <elke27_lib.elk.Elk object at 0x1037206e0>, kind = 'network_rssi_updated'\ntimeout_s = 10.0\n\n    def _wait_for_auth_required(elk: Elk, kind: str, timeout_s: float):\n        deadline = time.monotonic() + timeout_s\n        while time.monotonic() < deadline:\n            elk.session.pump_once(timeout_s=0.5)\n            for evt in elk.drain_events():\n                if evt.kind == ApiError.KIND:\n>                   pytest.fail(f\"{kind} returned ApiError error_code={evt.error_code}\")\nE                   Failed: network_rssi_updated returned ApiError error_code=11022\n\ntest/test_e27_network_param_live.py:102: Failed"}}
