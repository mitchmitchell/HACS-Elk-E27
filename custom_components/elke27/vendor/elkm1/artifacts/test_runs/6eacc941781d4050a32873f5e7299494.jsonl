{"run_id": "6eacc941781d4050a32873f5e7299494", "test_id": "test/test_live_e27_users_download.py::test_live_users_download", "record_type": "test_start", "t_ms": 0, "ts_utc": "2026-01-04T05:11:54Z", "meta": {"pid": 60094}}
{"run_id": "6eacc941781d4050a32873f5e7299494", "test_id": "test/test_live_e27_users_download.py::test_live_users_download", "record_type": "test_end", "t_ms": 10377, "ts_utc": "2026-01-04T05:12:04Z", "outcome": "fail", "error": {"when": "call", "longrepr": "live_e27_client = <elke27_lib.client.Elke27Client object at 0x10c0086e0>\n\n    @pytest.mark.live_e27\n    @pytest.mark.asyncio\n    async def test_live_users_download(live_e27_client: Elke27Client) -> None:\n        pin = _get_pin()\n        live_e27_client.set_authenticated_role(\"any_user\")\n        auth_result = await live_e27_client.async_execute(\"control_authenticate\", pin=pin)\n        if not auth_result.ok:\n            pytest.fail(f\"control.authenticate failed: {describe_error(auth_result.error)}\")\n    \n        configured = await live_e27_client.async_execute(\"user_get_configured\", timeout_s=_LIVE_TIMEOUT_S)\n        if not configured.ok:\n            if extract_error_code(configured.error) == E27ErrorCode.ELKERR_NOT_READY:\n                pytest.skip(\"Panel reported not-ready for user_get_configured.\")\n            pytest.fail(f\"user_get_configured failed: {describe_error(configured.error)}\")\n    \n        user_ids = configured.data.get(\"users\") if configured.data else None\n        if not isinstance(user_ids, list):\n            pytest.skip(\"No configured users reported.\")\n    \n        user_ids = [user_id for user_id in user_ids if isinstance(user_id, int) and user_id >= 1]\n        if not user_ids:\n            pytest.skip(\"No configured users reported.\")\n    \n        last_error = None\n        for user_id in user_ids:\n            auth_result = await live_e27_client.async_execute(\"control_authenticate\", pin=pin)\n            if not auth_result.ok:\n                pytest.fail(f\"control.authenticate failed: {describe_error(auth_result.error)}\")\n    \n            result = await live_e27_client.async_execute(\n                \"user_get_attribs\",\n                user_id=user_id,\n                pin=str(pin),\n                timeout_s=_LIVE_TIMEOUT_S,\n            )\n            if not result.ok:\n                code = extract_error_code(result.error)\n                if code == E27ErrorCode.ELKERR_NOT_READY:\n                    pytest.skip(\"Panel reported not-ready for user_get_attribs.\")\n                if code == E27ErrorCode.ELKERR_NOAUTH:\n                    pytest.fail(f\"user_get_attribs rejected after authenticate: {describe_error(result.error)}\")\n                last_error = result.error\n                continue\n            if result.ok:\n                user = live_e27_client._kernel.state.users.get(user_id)\n                if user is not None:\n                    return\n    \n        if last_error is not None:\n>           pytest.fail(f\"User attribs unavailable after authenticate: {describe_error(last_error)}\")\nE           Failed: User attribs unavailable after authenticate: Authorization is required for this operation.\n\ntest/test_live_e27_users_download.py:84: Failed"}}
